<p><span class="dimmed"><strong><span>Paradigms → OOP → Associations →
</span></strong></span></p>
<div id="title-and-body">
<div><h4 id="composition"><span>Composition</span><a class="fa fa-anchor" href="#composition" onclick="event.stopPropagation()"></a></h4></div>
<div id="main">
<div>
<p><strong>A composition is an association that represents a strong <em>whole-part</em> relationship.</strong></p>
<box>
<p><span><span aria-hidden="true" class="fas fa-cube"></span></span> A <code class="line-numbers hljs inline no-lang" v-pre>Board</code> (used for playing board games) consists of <code class="line-numbers hljs inline no-lang" v-pre>Square</code> objects.</p></box>
<p><strong>Composition implies</strong>,</p>
<ol>
<li><strong>when the <em>whole</em> is destroyed, <em>parts</em> are destroyed too</strong> i.e., the <em>part</em> cannot exist without being attached to a <em>whole</em>.</li>
<li><strong>there cannot be cyclical links</strong>.</li></ol>
<box>
<p><span><span aria-hidden="true" class="fas fa-cube"></span></span> The ‘sub-folder’ association between <code class="line-numbers hljs inline no-lang" v-pre>Folder</code> objects is a composition type association. Consider the case of <code class="line-numbers hljs inline no-lang" v-pre>Folder</code> object <code class="line-numbers hljs inline no-lang" v-pre>subF</code> is a sub-folder of <code class="line-numbers hljs inline no-lang" v-pre>Folder</code> object <code class="line-numbers hljs inline no-lang" v-pre>F</code>. In this case,</p>
<ol>
<li>if <code class="line-numbers hljs inline no-lang" v-pre>F</code> is deleted, <code class="line-numbers hljs inline no-lang" v-pre>subF</code> will be deleted with it.</li>
<li><code class="line-numbers hljs inline no-lang" v-pre>F</code> cannot be a sub-folder of <code class="line-numbers hljs inline no-lang" v-pre>subF</code> (i.e., no cyclical 'sub-folder' association between the two objects).</li></ol></box>
<p><strong>Whether a relationship is a composition can depend on the context</strong>.</p>
<box>
<p><span><span aria-hidden="true" class="fas fa-cube"></span></span> Is the relationship between <code class="line-numbers hljs inline no-lang" v-pre>Email</code> and <code class="line-numbers hljs inline no-lang" v-pre>EmailSubject</code> composition? That is, is the email subject <em>part</em> of an email to the extent that an email subject cannot exist without an email?</p>
<ul>
<li>When modeling an application that sends emails, the answer is 'yes'.</li>
<li>When modeling an application that gather analytics about email traffic, the answer may be 'no' <span class="dimmed">(e.g., the application might collect just the email subjects for text analysis)</span>.</li></ul></box>
<p><strong>A common use of composition is when parts of a big class are carved out as smaller classes</strong> for the ease of managing the internal design. In such cases, the classes extracted out still act as <em>parts</em> of the bigger class and the outside world has no business knowing about them.</p>
<p><strong><em>Cascading deletion</em> alone is not sufficient for composition.</strong> Suppose there is a design in which <code class="line-numbers hljs inline no-lang" v-pre>Person</code> objects are attached to <code class="line-numbers hljs inline no-lang" v-pre>Task</code> objects and the former get deleted whenever the latter is deleted. This fact alone does not mean there is a composition relationship between the two classes. For it to be composition, a <code class="line-numbers hljs inline no-lang" v-pre>Person</code> must be an integral <em>part</em> of a <code class="line-numbers hljs inline no-lang" v-pre>Task</code> in the context of that association, at the concept level (not simply at implementation level).</p>
<p><strong>Identifying and keeping track of composition relationships in the design has benefits</strong> such as helping to maintain the data integrity of the system. For example, when you know that a certain relationship is a composition, you can take extra care in your implementation to ensure that when the <em>whole</em> object is deleted, all its <em>parts</em> are deleted too.</p>
<h5 id="implementing-composition">Implementing composition<a class="fa fa-anchor" href="#implementing-composition" onclick="event.stopPropagation()"></a></h5>
<p><strong>Composition is implemented using a normal variable.</strong> If correctly implemented, the ‘part’ object will be deleted when the ‘whole’ object is deleted. Ideally, the ‘part’ object may not even be visible to clients of the ‘whole’ object.</p>
<box>
<p><span><span aria-hidden="true" class="fas fa-cube"></span></span> Here is one way to implement the composition between <code class="line-numbers hljs inline no-lang" v-pre>Email</code> and <code class="line-numbers hljs inline no-lang" v-pre>Subject</code>:</p>
<div class="alt-java">
<pre><code class="line-numbers hljs java" v-pre><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Email</span> </span>{
</span><span>    <span class="hljs-keyword">private</span> Subject subject;
</span><span>  ...
</span><span>}
</span></code><div class="function-btn-container"><button onclick="copyCodeBlock(this)" class="function-btn">
    <div class="function-btn-body">
    
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18" viewBox="0 0 18 18" version="1.1">
    <g id="surface1">
      <path d="M 11.273438 0 L 2.546875 0 C 1.746094 0 1.089844 0.613281 1.089844
      1.363281 L 1.089844 10.910156 L 2.546875 10.910156 L 2.546875 1.363281 L 11.273438
      1.363281 Z M 13.453125 2.726562 L 5.453125 2.726562 C 4.65625 2.726562 4 3.339844 4
      4.089844 L 4 13.636719 C 4 14.386719 4.65625 15 5.453125 15 L 13.453125 15 C 14.253906
      15 14.910156 14.386719 14.910156 13.636719 L 14.910156 4.089844 C 14.910156 3.339844
      14.253906 2.726562 13.453125 2.726562 Z M 13.453125 13.636719 L 5.453125 13.636719 L
      5.453125 4.089844 L 13.453125 4.089844 Z M 13.453125 13.636719 "/>
    </g>
</svg>

    </div>
    </button></div></pre></div>
<div class="alt-python">
<pre><code class="line-numbers hljs python" v-pre><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Email</span>:</span>
</span><span>
</span><span>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
</span><span>    self.__subject = Subject()
</span></code><div class="function-btn-container"><button onclick="copyCodeBlock(this)" class="function-btn">
    <div class="function-btn-body">
    
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18" viewBox="0 0 18 18" version="1.1">
    <g id="surface1">
      <path d="M 11.273438 0 L 2.546875 0 C 1.746094 0 1.089844 0.613281 1.089844
      1.363281 L 1.089844 10.910156 L 2.546875 10.910156 L 2.546875 1.363281 L 11.273438
      1.363281 Z M 13.453125 2.726562 L 5.453125 2.726562 C 4.65625 2.726562 4 3.339844 4
      4.089844 L 4 13.636719 C 4 14.386719 4.65625 15 5.453125 15 L 13.453125 15 C 14.253906
      15 14.910156 14.386719 14.910156 13.636719 L 14.910156 4.089844 C 14.910156 3.339844
      14.253906 2.726562 13.453125 2.726562 Z M 13.453125 13.636719 L 5.453125 13.636719 L
      5.453125 4.089844 L 13.453125 4.089844 Z M 13.453125 13.636719 "/>
    </g>
</svg>

    </div>
    </button></div></pre></div>
<p><span><span aria-hidden="true" class="fas fa-cube"></span></span> In this code, the <code class="line-numbers hljs inline no-lang" v-pre>Email</code> has a composition type relationship with the <code class="line-numbers hljs inline no-lang" v-pre>Subject</code> class, in the sense that the subject is part of the email.</p></box></div>
<div></div></div></div>